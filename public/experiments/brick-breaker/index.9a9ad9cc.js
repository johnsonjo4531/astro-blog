window.GameState=function(e){var t={winner:!1};t.unit=e.unit,t.width=e.width,t.height=e.height,t.maxPoints=0,t.removedBricks=new Set,(()=>{var e=0;Object.defineProperty(t,"points",{get:()=>e,set(r){Math.floor(r/100)-Math.floor(e/100)>=1&&t.balls.add(s()),e=r}});var r=!1;Object.defineProperty(t,"paused",{get:()=>r,set(e){r=!!e}});var a=!1;Object.defineProperty(t,"ready",{get:()=>!t.paused&&a,set(e){a=!!e}})})();t.paddlesLeft=3,t.gameOver=!1;const r=20*e.unit;function a(){t.ready=!1,t.countdown=3;var e=setInterval((function(){t.paused||(t.countdown-=1,0===t.countdown&&(t.ready=!0,clearInterval(e)))}),1e3)}a();var d=null,i=[];function n(t){return e.unit/(1e3/60)*t}function l(){t.paddle.speed=n(2),t.paddle.x=e.width/2-t.paddle.width/2,t.paddle.width=r}t.update=function(n){for(var o of t.balls){if(o.paddleContact=!1,o.brickContact=!1,o.wallContact=!1,!t.ready)return;if(o.x+o.radius>e.width&&(o.reflectLeft(),o.wallContact=!0),o.y-o.radius<0&&(o.reflectDown(),o.wallContact=!0),o.y-o.radius>e.height){if(t.balls.delete(o),0===t.balls.size){if(t.paddlesLeft--,0===t.paddlesLeft)return t.gameOver=!0,void e.gameOver(t);a(),l(),t.balls.add(s())}}else{o.x-o.radius<0&&(o.reflectRight(),o.wallContact=!0),o.boundingRect.intersectsRect(t.paddle)&&(o.reflectUp(),o.deltaPerMS.x=o.speed*(o.x-t.paddle.center.x)/(t.paddle.width/2),o.paddleContact=!0);var c=o.boundingRect;if(c.intersectsRect(d))for(var h=0;h<t.bricks.length;++h){const e=t.bricks[h];if(0!==e.length&&c.intersectsRect(i[h]))for(var f of e){var p=c.intersectsRect(f);if(p)switch(0===h&&(t.paddle.width=r/2),t.removedBricks.add(f),o.brickContact=!0,o.breaks++,t.points+=f.points,p){case"top":o.reflectUp();break;case"bottom":o.reflectDown();break;case"right":o.reflectRight();break;case"left":o.reflectLeft()}}}o.x+=o.deltaPerMS.x*n,o.y+=o.deltaPerMS.y*n}}t.removedBricks.size>0&&(t.bricks=t.bricks.map((e=>{if(0==e.length)return[];var r=e.filter((e=>!t.removedBricks.has(e)));return 0===r.length&&(t.points+=25),r})),t.bricks.every((e=>0===e.length))&&(t.gameOver=!0,t.winner=!0,t.points+=3*t.balls.size+5*t.paddlesLeft,e.gameOver(t)))},function(){var r=.35*e.height,a=.2*e.height,n=["#FFD87D","#FFD87D","#FFAC69","#FFAC69","#85D1C2","#85D1C2","#D3F05F","#D3F05F"].reverse(),l=[1,1,2,2,3,3,5,5].reverse();const o=n.length;t.maxPoints=l.reduce(((e,t)=>e+14*t),0)+25*l.length,t.bricks=[];for(var c=0;c<o;++c){t.bricks[c]=[];for(var s=0;s<14;++s){t.bricks[c][s]=Geometry.Rectangle({width:(e.width-75)/14,height:(r-5*(o-1))/o});let d=t.bricks[c][s];d.x=5*(s+1)+d.width*s,d.y=a+5*c+d.height*c,d.color=n[c],d.points=l[c],d.broken=!1}}var h,f,p;h=t.bricks,f=h[0][0],p=h[h.length-1][h[0].length-1],d=Geometry.Rectangle({x:f.left,y:f.top,width:p.right-f.left,height:p.bottom-f.top}),i=t.bricks.map((e=>function(e){var t=e[0],r=e[e.length-1];return Geometry.Rectangle({x:t.left,y:t.top,width:r.right-t.left,height:r.bottom-t.top})}(e)))}(),t.paddle=Geometry.Rectangle({width:r,height:4*e.unit}),l(),t.paddle.y=e.height-t.paddle.height-2*t.paddle.height,t.paddle.color="cornflowerblue";var o,c=(o=["tomato","gold","DarkTurquoise","DarkSlateGrey","LightGreen"],()=>{var e=o.shift();return o.push(e),e});function s(){var r={};(r=Geometry.Circle({radius:2*e.unit})).color=c();var a=0;Object.defineProperty(r,"breaks",{get:()=>a,set(e){a=e,e>=62?r.speed=n(2.5):e>=36?r.speed=n(2):e>=12?r.speed=n(1.5):e>=4&&(r.speed=n(1))}}),r.x=t.paddle.width/2+t.paddle.x,r.y=t.paddle.top-t.paddle.height/2-r.radius;var d=n(.5);return Object.defineProperty(r,"speed",{get:()=>d,set(e){d!==e&&(r.deltaPerMS.x*=e/d,r.deltaPerMS.y*=e/d,d=e)}}),r.deltaPerMS={x:r.speed,y:-r.speed},r.paddleContact=!1,r.brickContact=!1,r.wallContact=!1,r.reflectLeft=function(){r.deltaPerMS.x=-1*Math.abs(r.deltaPerMS.x)},r.reflectRight=function(){r.deltaPerMS.x=Math.abs(r.deltaPerMS.x)},r.reflectDown=function(){r.deltaPerMS.y=Math.abs(r.deltaPerMS.y)},r.reflectUp=function(){r.deltaPerMS.y=-1*Math.abs(r.deltaPerMS.y)},r}return t.balls=new Set([s()]),t};
//# sourceMappingURL=index.9a9ad9cc.js.map
